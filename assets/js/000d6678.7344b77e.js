"use strict";(self.webpackChunkbee_docs=self.webpackChunkbee_docs||[]).push([[2250],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return b}});var o=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),d=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},u=function(e){var n=d(e.components);return o.createElement(s.Provider,{value:n},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},c=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=d(t),c=r,b=p["".concat(s,".").concat(c)]||p[c]||g[c]||i;return t?o.createElement(b,a(a({ref:n},u),{},{components:t})):o.createElement(b,a({ref:n},u))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[p]="string"==typeof e?e:r,a[1]=l;for(var d=2;d<i;d++)a[d]=t[d];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}c.displayName="MDXCreateElement"},5512:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return s},default:function(){return b},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return p}});var o=t(87462),r=t(63366),i=(t(67294),t(3905)),a=["components"],l={title:"Logs and Files",id:"logs-and-files"},s=void 0,d={unversionedId:"bee/working-with-bee/logs-and-files",id:"bee/working-with-bee/logs-and-files",title:"Logs and Files",description:"Linux",source:"@site/docs/bee/working-with-bee/logs-and-files.md",sourceDirName:"bee/working-with-bee",slug:"/bee/working-with-bee/logs-and-files",permalink:"/docs/bee/working-with-bee/logs-and-files",draft:!1,editUrl:"https://github.com/ethersphere/docs.github.io/blob/master/docs/bee/working-with-bee/logs-and-files.md",tags:[],version:"current",frontMatter:{title:"Logs and Files",id:"logs-and-files"},sidebar:"bee",previous:{title:"Debug API",permalink:"/docs/bee/working-with-bee/debug-api"},next:{title:"Bee Tools",permalink:"/docs/bee/working-with-bee/bee-tools"}},u={},p=[{value:"Linux",id:"linux",level:3},{value:"MacOS",id:"macos",level:3},{value:"Data Locations",id:"data-locations",level:2},{value:"Bee",id:"bee",level:3},{value:"Logging Guidelines",id:"logging-guidelines",level:2},{value:"Log Levels",id:"log-levels",level:3},{value:"Logging API usage",id:"logging-api-usage",level:3}],g={toc:p},c="wrapper";function b(e){var n=e.components,t=(0,r.Z)(e,a);return(0,i.kt)(c,(0,o.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"linux"},"Linux"),(0,i.kt)("p",null,"If you have installed Bee on Linux using a package manager you will now be able to manage your Bee service using ",(0,i.kt)("inlineCode",{parentName:"p"},"systemctl"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl status bee\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\u25cf bee.service - Bee - Ethereum Swarm node\n     Loaded: loaded (/lib/systemd/system/bee.service; enabled; vendor preset: enabled)\n     Active: active (running) since Fri 2020-11-20 23:50:15 GMT; 6s ago\n")),(0,i.kt)("p",null,"Logs are available using the ",(0,i.kt)("inlineCode",{parentName:"p"},"journalctl")," command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"journalctl --lines=100 --follow --unit bee\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"INFO[2021-02-09T18:55:11Z] swarm public key 03379f7aa673b7f03737064fd23ba1453619924a4602e70bbccc133ba67d0968bd\nDEBU[2021-02-09T18:55:11Z] using existing libp2p key\nDEBU[2021-02-09T18:55:11Z] using existing pss key\nINFO[2021-02-09T18:55:11Z] pss public key 03bae655ce94431e1f2c2de8d017f88c8c5c293ef0057379223084aba9e318596e\nINFO[2021-02-09T18:55:11Z] using ethereum address 99c9e7868d22244106a5ffbc2f5d6b7c88e2c85a\nINFO[2021-02-09T18:55:14Z] using default factory address for chain id 5: f0277caffea72734853b834afc9892461ea18474\nINFO[2021-02-09T18:55:14Z] no chequebook found, deploying new one.\nWARN[2021-02-09T18:55:15Z] cannot continue until there is sufficient ETH (for Gas) and at least 10 BZZ available on 99c9e7868d22244106a5ffbc2f5d6b7c88e2c85a\n")),(0,i.kt)("h3",{id:"macos"},"MacOS"),(0,i.kt)("p",null,"Services are managed using Homebrew services."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"brew services restart swarm-bee\n")),(0,i.kt)("p",null,"Logs are available at ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/local/var/log/swarm-bee/bee.log")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"tail -f /usr/local/var/log/swarm-bee/bee.log\n")),(0,i.kt)("h2",{id:"data-locations"},"Data Locations"),(0,i.kt)("h3",{id:"bee"},"Bee"),(0,i.kt)("p",null,"Configuration files are stored in ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/bee/"),". State, chunks and other data are stored in ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/lib/bee/")),(0,i.kt)("h2",{id:"logging-guidelines"},"Logging Guidelines"),(0,i.kt)("p",null,"The Bee logs provide a robust information on the workings of a Bee node which are useful both to node operators and to Bee developers. Log messages have four levels described below, and logs can be adjusted for verbosity and granularity to suit the needs of the user."),(0,i.kt)("h3",{id:"log-levels"},"Log Levels"),(0,i.kt)("p",null,"The log messages are divided into four basic levels:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Error")," - Errors in the node. Although the node operation may continue, the error indicates that it should be addressed."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Warning")," - Warnings should be checked in case the problem recurs to avoid potential damage."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Info")," - Informational messages useful for node operators that do not indicate any fault or error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Debug")," - Information concerning program logic decisions, diagnostic information, internal state, etc. which is primarily useful for developers.")),(0,i.kt)("p",null,"There is a notion of ",(0,i.kt)("inlineCode",{parentName:"p"},"V-level")," attached to the ",(0,i.kt)("inlineCode",{parentName:"p"},"Debug")," level. ",(0,i.kt)("inlineCode",{parentName:"p"},"V-levels")," provide a simple way of changing the verbosity of debug messages. ",(0,i.kt)("inlineCode",{parentName:"p"},"V-levels")," provide a way for a given package to distinguish the relative importance or verbosity of a given log message. Then, if a particular logger or package logs too many messages, the package can simply change the ",(0,i.kt)("inlineCode",{parentName:"p"},"V")," level for that logger."),(0,i.kt)("h3",{id:"logging-api-usage"},"Logging API usage"),(0,i.kt)("p",null,"In the current Bee code base, it is possible to change the granularity of logging for some services on the fly without the need to restart the node. These services and their corresponding loggers can be found using the ",(0,i.kt)("inlineCode",{parentName:"p"},"/loggers")," endpoint. Example of the output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tree": {\n    "node": {\n      "/": {\n        "api": {\n          "+": [\n            "info|node/api[0][]>>824634933256"\n          ]\n        },\n        "batchstore": {\n          "+": [\n            "info|node/batchstore[0][]>>824634933256"\n          ]\n        },\n        "leveldb": {\n          "+": [\n            "info|node/leveldb[0][]>>824634933256"\n          ]\n        },\n        "pseudosettle": {\n          "+": [\n            "info|node/pseudosettle[0][]>>824634933256"\n          ]\n        },\n        "pss": {\n          "+": [\n            "info|node/pss[0][]>>824634933256"\n          ]\n        },\n        "storer": {\n          "+": [\n            "info|node/storer[0][]>>824634933256"\n          ]\n        }\n      },\n      "+": [\n        "info|node[0][]>>824634933256"\n      ]\n    }\n  },\n  "loggers": [\n    {\n      "logger": "node/api",\n      "verbosity": "info",\n      "subsystem": "node/api[0][]>>824634933256",\n      "id": "bm9kZS9hcGlbMF1bXT4-ODI0NjM0OTMzMjU2"\n    },\n    {\n      "logger": "node/storer",\n      "verbosity": "info",\n      "subsystem": "node/storer[0][]>>824634933256",\n      "id": "bm9kZS9zdG9yZXJbMF1bXT4-ODI0NjM0OTMzMjU2"\n    },\n    {\n      "logger": "node/pss",\n      "verbosity": "info",\n      "subsystem": "node/pss[0][]>>824634933256",\n      "id": "bm9kZS9wc3NbMF1bXT4-ODI0NjM0OTMzMjU2"\n    },\n    {\n      "logger": "node/pseudosettle",\n      "verbosity": "info",\n      "subsystem": "node/pseudosettle[0][]>>824634933256",\n      "id": "bm9kZS9wc2V1ZG9zZXR0bGVbMF1bXT4-ODI0NjM0OTMzMjU2"\n    },\n    {\n      "logger": "node",\n      "verbosity": "info",\n      "subsystem": "node[0][]>>824634933256",\n      "id": "bm9kZVswXVtdPj44MjQ2MzQ5MzMyNTY="\n    },\n    {\n      "logger": "node/leveldb",\n      "verbosity": "info",\n      "subsystem": "node/leveldb[0][]>>824634933256",\n      "id": "bm9kZS9sZXZlbGRiWzBdW10-PjgyNDYzNDkzMzI1Ng=="\n    },\n    {\n      "logger": "node/batchstore",\n      "verbosity": "info",\n      "subsystem": "node/batchstore[0][]>>824634933256",\n      "id": "bm9kZS9iYXRjaHN0b3JlWzBdW10-PjgyNDYzNDkzMzI1Ng=="\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"The recorders come in two versions. The first is the tree version and the second is the flattened version. The ",(0,i.kt)("inlineCode",{parentName:"p"},"subsystem")," field is the unique identifier of the logger. The ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," field is a version of the ",(0,i.kt)("inlineCode",{parentName:"p"},"subsystem")," field encoded in base 64 for easier reference to a particular logger. The node name of the version tree is composed of the subsystem with the log level prefix and delimited by the ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," character. The number in the first square bracket indicates the logger's V-level."),(0,i.kt)("p",null,"The logger endpoint uses HTTP PUT requests to modify the verbosity of the logger(s). The request must have the following parameters ",(0,i.kt)("inlineCode",{parentName:"p"},"/loggers/{subsystem}/{verbosity}"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"{subsytem}")," parameter is the base64 version of the subsytem field or regular expression corresponding to multiple subsystems. Since the loggers are arranged in tree structure, it is possible to turn on/off or change the logging level of the entire tree or just its branches with a single command. The verbosity can be one of ",(0,i.kt)("inlineCode",{parentName:"p"},"none"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"error"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"warning"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"info"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"debug")," or a number in the range ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"1<<<31 - 1")," to enable the verbosity of a particular V-level, if available for a given logger. A value of ",(0,i.kt)("inlineCode",{parentName:"p"},"all")," will enable the highest verbosity of V-level."),(0,i.kt)("p",null,"Examples:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"curl -XPUT http://localhost:1635/loggers/bm9kZS8q/none")," - will disable all loggers; ",(0,i.kt)("inlineCode",{parentName:"p"},"bm9kZS8q")," is base64 encoded ",(0,i.kt)("inlineCode",{parentName:"p"},"node/*")," regular expression."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"curl -XPUT http://localhost:1635/loggers/bm9kZS9hcGlbMV1bXT4-ODI0NjM0OTMzMjU2/error")," - will set the verbosity of the logger with the subsystem ",(0,i.kt)("inlineCode",{parentName:"p"},"node/api[1][]>>824634933256")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"error"),"."))}b.isMDXComponent=!0}}]);