"use strict";(self.webpackChunkbee_docs=self.webpackChunkbee_docs||[]).push([[5202],{3905:function(a,t,e){e.d(t,{Zo:function(){return o},kt:function(){return k}});var s=e(67294);function m(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function n(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,s)}return e}function p(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?n(Object(e),!0).forEach((function(t){m(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function r(a,t){if(null==a)return{};var e,s,m=function(a,t){if(null==a)return{};var e,s,m={},n=Object.keys(a);for(s=0;s<n.length;s++)e=n[s],t.indexOf(e)>=0||(m[e]=a[e]);return m}(a,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);for(s=0;s<n.length;s++)e=n[s],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(m[e]=a[e])}return m}var l=s.createContext({}),i=function(a){var t=s.useContext(l),e=t;return a&&(e="function"==typeof a?a(t):p(p({},t),a)),e},o=function(a){var t=i(a.components);return s.createElement(l.Provider,{value:t},a.children)},N="mdxType",c={inlineCode:"code",wrapper:function(a){var t=a.children;return s.createElement(s.Fragment,{},t)}},h=s.forwardRef((function(a,t){var e=a.components,m=a.mdxType,n=a.originalType,l=a.parentName,o=r(a,["components","mdxType","originalType","parentName"]),N=i(e),h=m,k=N["".concat(l,".").concat(h)]||N[h]||c[h]||n;return e?s.createElement(k,p(p({ref:t},o),{},{components:e})):s.createElement(k,p({ref:t},o))}));function k(a,t){var e=arguments,m=t&&t.mdxType;if("string"==typeof a||m){var n=e.length,p=new Array(n);p[0]=h;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=a,r[N]="string"==typeof a?a:m,p[1]=r;for(var i=2;i<n;i++)p[i]=e[i];return s.createElement.apply(null,p)}return s.createElement.apply(null,e)}h.displayName="MDXCreateElement"},50304:function(a,t,e){e.r(t),e.d(t,{assets:function(){return h},contentTitle:function(){return N},default:function(){return g},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return k}});var s=e(87462),m=e(63366),n=e(67294),p=e(3905);function r(){var a=(0,n.useState)(""),t=a[0],e=a[1],s=(0,n.useState)(""),m=s[0],p=s[1];return n.createElement("div",null,n.createElement("div",null,n.createElement("input",{placeholder:"Input batch depth",onChange:function(a){e(""),p(a.target.value)}}),n.createElement("button",{onClick:function(){var a=Number(m);if(!Number.isInteger(a)||a<1)e("Please input a positive integer.");else{var t=Intl.NumberFormat().format(4*Math.pow(2,a));e(t+" kb")}}},"Calculate")),n.createElement("div",null,"Maximum batch data: ",t))}function l(){var a=(0,n.useState)(""),t=a[0],e=a[1],s=(0,n.useState)(""),m=s[0],p=s[1],r=(0,n.useState)(""),l=r[0],i=r[1];return n.createElement("div",null,n.createElement("div",null,n.createElement("input",{placeholder:"Input batch depth",onChange:function(a){e(""),p(a.target.value)}}),n.createElement("input",{placeholder:"Input batch amount",onChange:function(a){e(""),i(a.target.value)}}),n.createElement("button",{onClick:function(){var a=Number(m),t=Number(l);if(!Number.isInteger(a)||a<1||!Number.isInteger(t)||t<1)e("Please input positive integers for depth and amount.");else{var s=Intl.NumberFormat().format(Math.pow(2,a)*t/1e16);e(s+" xBZZ")}}},"Calculate")),n.createElement("div",null,"Batch cost: ",t))}var i=["components"],o={title:"Postage Stamp",id:"postage-stamp"},N=void 0,c={unversionedId:"learn/technology/contracts/postage-stamp",id:"learn/technology/contracts/postage-stamp",title:"Postage Stamp",description:"The postage stamp contract is a smart contract which is a key part of Swarm's storage incentives which make up the foundation of Swarm's self-sustaining economic system. It allows users to purchase batches of postage stamps for xBZZ tokens. These stamps can then be used to attach to chunks that are uploaded to the Swarm network.",source:"@site/docs/learn/technology/contracts/postage-stamp.md",sourceDirName:"learn/technology/contracts",slug:"/learn/technology/contracts/postage-stamp",permalink:"/docs/learn/technology/contracts/postage-stamp",draft:!1,editUrl:"https://github.com/ethersphere/docs.github.io/blob/master/docs/learn/technology/contracts/postage-stamp.md",tags:[],version:"current",frontMatter:{title:"Postage Stamp",id:"postage-stamp"},sidebar:"learn",previous:{title:"Chequebook",permalink:"/docs/learn/technology/contracts/chequebook"},next:{title:"Price Oracle",permalink:"/docs/learn/technology/contracts/price-oracle"}},h={},k=[{value:"Bucket Depth",id:"bucket-depth",level:2},{value:"Batch Depth and Batch Amount",id:"batch-depth-and-batch-amount",level:2},{value:"Batch Depth",id:"batch-depth",level:3},{value:"Depth to kb calculator:",id:"depth-to-kb-calculator",level:4},{value:"Batch Amount",id:"batch-amount",level:3},{value:"Batch cost calculator:",id:"batch-cost-calculator",level:4},{value:"Batch Utilisation",id:"batch-utilisation",level:2},{value:"Immutable Batches",id:"immutable-batches",level:3},{value:"Mutable Batches",id:"mutable-batches",level:3}],u={toc:k},d="wrapper";function g(a){var t=a.components,n=(0,m.Z)(a,i);return(0,p.kt)(d,(0,s.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("p",null,"The ",(0,p.kt)("a",{parentName:"p",href:"https://github.com/ethersphere/storage-incentives/blob/master/src/PostageStamp.sol"},"postage stamp contract")," is a smart contract which is a key part of Swarm's ",(0,p.kt)("a",{parentName:"p",href:"/docs/learn/technology/incentives"},"storage incentives")," which make up the foundation of Swarm's self-sustaining economic system. It allows users to purchase batches of postage stamps for xBZZ tokens. These stamps can then be used to attach to ",(0,p.kt)("a",{parentName:"p",href:"/docs/learn/technology/DISC"},"chunks")," that are uploaded to the Swarm network."),(0,p.kt)("p",null,"When a node uploads data to Swarm, it attaches postage stamps to each chunk of data. Postage stamps are issued in batches rather than one by one. The value assigned to a stamp indicates how much it is worth to persist the associated data on Swarm, which nodes use to prioritize which chunks to remove from their reserve first."),(0,p.kt)("p",null,"The value of a postage stamp decreases over time as if storage rent was regularly deducted from the batch balance. Once the value of a stamp is no longer sufficient, the associated chunk is evicted from the reserve."),(0,p.kt)("h2",{id:"bucket-depth"},"Bucket Depth"),(0,p.kt)("p",null,"Postage stamps are issued in batches with a certain number of storage slots divided amongst ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"u"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"k"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{bucketDepth}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"u"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"e"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h")))))))))))))," equally sized address space buckets. Each bucket is responsible for storing chunks that fall within a certain range of address space. When uploaded, files are split into 4kb chunks, each chunk is assigned a unique address, and each chunk is then assigned to the bucket in which its address falls. While the value of ",(0,p.kt)("inlineCode",{parentName:"p"},"bucket depth")," is not defined in The Book of Swarm, in its current implementation in the Bee client, ",(0,p.kt)("inlineCode",{parentName:"p"},"bucket depth")," has been set to 16, so there are a total of 65,536 buckets."),(0,p.kt)("h2",{id:"batch-depth-and-batch-amount"},"Batch Depth and Batch Amount"),(0,p.kt)("p",null,"Each batch of stamps has two key parameters, ",(0,p.kt)("inlineCode",{parentName:"p"},"batch depth")," and ",(0,p.kt)("inlineCode",{parentName:"p"},"amount"),', which are recorded on Gnosis Chain at issuance. Note that these "depths" do not refer to the depth terms used to describe topology which are outlined ',(0,p.kt)("a",{parentName:"p",href:"/docs/learn/glossary#depth-types"},"here in the glossary"),"."),(0,p.kt)("h3",{id:"batch-depth"},"Batch Depth"),(0,p.kt)("p",null,(0,p.kt)("inlineCode",{parentName:"p"},"Batch depth")," is a measurement of how much data can be stored by a batch. The number of chunks which can be stored (stamped) by a batch is equal to  ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mi",{parentName:"mrow"},"d"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{depth}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"e"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"))))))))))))),". "),(0,p.kt)("p",null,(0,p.kt)("inlineCode",{parentName:"p"},"Batch depth")," determines how many chunks are allowed in each bucket. The number of chunks allowed in each bucket is calculated like so:"),(0,p.kt)("div",{className:"math math-display"},(0,p.kt)("span",{parentName:"div",className:"katex-display"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"a"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mo",{parentName:"mrow"},"\u2212"),(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"u"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"k"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{(batchDepth - bucketDepth)}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.938em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.938em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"ba"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"u"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"e"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mclose mtight"},")")))))))))))))),(0,p.kt)("p",null,"For a batch with a ",(0,p.kt)("inlineCode",{parentName:"p"},"batch depth")," of 20, a maximum of ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mn",{parentName:"msup"},"20")),(0,p.kt)("mo",{parentName:"mrow"},"="),(0,p.kt)("mn",{parentName:"mrow"},"1"),(0,p.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,p.kt)("mn",{parentName:"mrow"},"048"),(0,p.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,p.kt)("mn",{parentName:"mrow"},"576")),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{20} = 1,048,576")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"20"))))))))),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,p.kt)("span",{parentName:"span",className:"mrel"},"="),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"1"),(0,p.kt)("span",{parentName:"span",className:"mpunct"},","),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"048"),(0,p.kt)("span",{parentName:"span",className:"mpunct"},","),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"576")))))," chunks can be stamped.   "),(0,p.kt)("p",null,"Given the constant ",(0,p.kt)("inlineCode",{parentName:"p"},"bucket depth")," of 16, for a ",(0,p.kt)("inlineCode",{parentName:"p"},"batch depth")," of 20, the number of chunks per bucket is calculated like so:"),(0,p.kt)("div",{className:"math math-display"},(0,p.kt)("span",{parentName:"div",className:"katex-display"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mn",{parentName:"mrow"},"20"),(0,p.kt)("mo",{parentName:"mrow"},"\u2212"),(0,p.kt)("mn",{parentName:"mrow"},"16"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")"))),(0,p.kt)("mo",{parentName:"mrow"},"="),(0,p.kt)("mn",{parentName:"mrow"},"16"),(0,p.kt)("mtext",{parentName:"mrow"},"\xa0chunks/bucket")),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{(20 - 16)} = 16 \\text{ chunks/bucket}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.938em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.938em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"20"),(0,p.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"16"),(0,p.kt)("span",{parentName:"span",className:"mclose mtight"},")"))))))))),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,p.kt)("span",{parentName:"span",className:"mrel"},"="),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"16"),(0,p.kt)("span",{parentName:"span",className:"mord text"},(0,p.kt)("span",{parentName:"span",className:"mord"},"\xa0chunks/bucket"))))))),(0,p.kt)("h4",{id:"depth-to-kb-calculator"},"Depth to kb calculator:"),(0,p.kt)(r,{mdxType:"DepthCalc"}),(0,p.kt)("h3",{id:"batch-amount"},"Batch Amount"),(0,p.kt)("p",null,"The ",(0,p.kt)("inlineCode",{parentName:"p"},"amount")," parameter is the quantity of xBZZ in PLUR ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mn",{parentName:"mrow"},"1"),(0,p.kt)("mo",{parentName:"mrow"},"\xd7"),(0,p.kt)("mn",{parentName:"mrow"},"1"),(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"0"),(0,p.kt)("mn",{parentName:"msup"},"16")),(0,p.kt)("mi",{parentName:"mrow"},"P"),(0,p.kt)("mi",{parentName:"mrow"},"L"),(0,p.kt)("mi",{parentName:"mrow"},"U"),(0,p.kt)("mi",{parentName:"mrow"},"R"),(0,p.kt)("mo",{parentName:"mrow"},"="),(0,p.kt)("mn",{parentName:"mrow"},"1"),(0,p.kt)("mtext",{parentName:"mrow"},"\xa0xBZZ"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"(1 \\times 10^{16}PLUR = 1 \\text{ xBZZ})")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,p.kt)("span",{parentName:"span",className:"mopen"},"("),(0,p.kt)("span",{parentName:"span",className:"mord"},"1"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,p.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"1"),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"0"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"16"))))))))),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"LU"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.00773em"}},"R"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,p.kt)("span",{parentName:"span",className:"mrel"},"="),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"1"),(0,p.kt)("span",{parentName:"span",className:"mord text"},(0,p.kt)("span",{parentName:"span",className:"mord"},"\xa0xBZZ")),(0,p.kt)("span",{parentName:"span",className:"mclose"},")")))))," that is assigned per chunk in the batch. The total number of xBZZ that will be paid for the batch is calculated from this figure and the ",(0,p.kt)("inlineCode",{parentName:"p"},"batch depth")," like so:"),(0,p.kt)("p",null,(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"a"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h"))),(0,p.kt)("mo",{parentName:"mrow"},"\xd7"),(0,p.kt)("mrow",{parentName:"mrow"},(0,p.kt)("mi",{parentName:"mrow"},"a"),(0,p.kt)("mi",{parentName:"mrow"},"m"),(0,p.kt)("mi",{parentName:"mrow"},"o"),(0,p.kt)("mi",{parentName:"mrow"},"u"),(0,p.kt)("mi",{parentName:"mrow"},"n"),(0,p.kt)("mi",{parentName:"mrow"},"t"))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{batchDepth} \\times {amount}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.9324em",verticalAlign:"-0.0833em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"ba"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"))))))))),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,p.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6151em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord mathnormal"},"am"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"))))))),(0,p.kt)("p",null,"The paid xBZZ forms the ",(0,p.kt)("inlineCode",{parentName:"p"},"balance")," of the batch. This ",(0,p.kt)("inlineCode",{parentName:"p"},"balance")," is then slowly depleted as time ticks on and blocks are mined on Gnosis Chain."),(0,p.kt)("p",null,"For example, with a ",(0,p.kt)("inlineCode",{parentName:"p"},"batch depth")," of 20 and an ",(0,p.kt)("inlineCode",{parentName:"p"},"amount")," of 1000000000 PLUR:"),(0,p.kt)("div",{className:"math math-display"},(0,p.kt)("span",{parentName:"div",className:"katex-display"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mn",{parentName:"msup"},"20")),(0,p.kt)("mo",{parentName:"mrow"},"\xd7"),(0,p.kt)("mn",{parentName:"mrow"},"1000000000"),(0,p.kt)("mo",{parentName:"mrow"},"="),(0,p.kt)("mn",{parentName:"mrow"},"1048576000000000"),(0,p.kt)("mtext",{parentName:"mrow"},"\xa0PLUR"),(0,p.kt)("mo",{parentName:"mrow"},"="),(0,p.kt)("mn",{parentName:"mrow"},"0.1048576"),(0,p.kt)("mtext",{parentName:"mrow"},"\xa0xBZZ")),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{20} \\times 1000000000 = 1048576000000000 \\text{ PLUR} = 0.1048576 \\text{ xBZZ}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.9474em",verticalAlign:"-0.0833em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8641em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"20"))))))))),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,p.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"1000000000"),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,p.kt)("span",{parentName:"span",className:"mrel"},"="),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"1048576000000000"),(0,p.kt)("span",{parentName:"span",className:"mord text"},(0,p.kt)("span",{parentName:"span",className:"mord"},"\xa0PLUR")),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,p.kt)("span",{parentName:"span",className:"mrel"},"="),(0,p.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},"0.1048576"),(0,p.kt)("span",{parentName:"span",className:"mord text"},(0,p.kt)("span",{parentName:"span",className:"mord"},"\xa0xBZZ"))))))),(0,p.kt)("h4",{id:"batch-cost-calculator"},"Batch cost calculator:"),(0,p.kt)(l,{mdxType:"BatchCostCalc"}),(0,p.kt)("h2",{id:"batch-utilisation"},"Batch Utilisation"),(0,p.kt)("h3",{id:"immutable-batches"},"Immutable Batches"),(0,p.kt)("p",null,"Utilisation of an immutable batch is computed using a hash map of size ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"u"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"k"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{bucketDepth}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"u"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"e"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h")))))))))))))," which is ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mn",{parentName:"msup"},"16"))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{16}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"16")))))))))))))," for all batches, so 65536 total entries. For the keys of the key-value pairs of the hash map, the keys are 16 digit binary numbers from 0 to 65535, and the value is a counter. "),(0,p.kt)("p",null,(0,p.kt)("img",{src:e(32544).Z,width:"2703",height:"963"})),(0,p.kt)("p",null,"As chunks are uploaded to Swarm, each chunk is assigned to a bucket based the first 16 binary digits of the ",(0,p.kt)("a",{parentName:"p",href:"/docs/learn/technology/disc#chunks"},"chunk's hash"),". The chunk will be assigned to whichever bucket's key matches the first 16 bits of its hash, and that bucket's counter will be incremented by 1. This is referred to as \"stamping\" a chunk. "),(0,p.kt)("p",null,'The batch is deemed "full" when ANY of these counters reach a certain max value. The max value is computed from the batch depth as such: ',(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"a"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mo",{parentName:"mrow"},"\u2212"),(0,p.kt)("mi",{parentName:"mrow"},"b"),(0,p.kt)("mi",{parentName:"mrow"},"u"),(0,p.kt)("mi",{parentName:"mrow"},"c"),(0,p.kt)("mi",{parentName:"mrow"},"k"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"D"),(0,p.kt)("mi",{parentName:"mrow"},"e"),(0,p.kt)("mi",{parentName:"mrow"},"p"),(0,p.kt)("mi",{parentName:"mrow"},"t"),(0,p.kt)("mi",{parentName:"mrow"},"h"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{(batchDepth-bucketDepth)}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.888em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.888em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"ba"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"u"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"c"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"e"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"De"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"pt"),(0,p.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h"),(0,p.kt)("span",{parentName:"span",className:"mclose mtight"},")"))))))))))))),". For example if the batch depth is 21, then the max value is ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mn",{parentName:"mrow"},"21"),(0,p.kt)("mo",{parentName:"mrow"},"\u2212"),(0,p.kt)("mn",{parentName:"mrow"},"16"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{(21-16)}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.888em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.888em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"21"),(0,p.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"16"),(0,p.kt)("span",{parentName:"span",className:"mclose mtight"},")"))))))))))))),' or 32. A bucket can be thought of as have a number of "slots" equal to this maximum value, and every time the bucket\'s counter is incremented, one of its slots gets filled. '),(0,p.kt)("p",null,"In the diagram below, the batch depth is 18, so there are ",(0,p.kt)("span",{parentName:"p",className:"math math-inline"},(0,p.kt)("span",{parentName:"span",className:"katex"},(0,p.kt)("span",{parentName:"span",className:"katex-mathml"},(0,p.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,p.kt)("semantics",{parentName:"math"},(0,p.kt)("mrow",{parentName:"semantics"},(0,p.kt)("msup",{parentName:"mrow"},(0,p.kt)("mn",{parentName:"msup"},"2"),(0,p.kt)("mrow",{parentName:"msup"},(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,p.kt)("mn",{parentName:"mrow"},"18"),(0,p.kt)("mo",{parentName:"mrow"},"\u2212"),(0,p.kt)("mn",{parentName:"mrow"},"16"),(0,p.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,p.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2^{(18-16)}")))),(0,p.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,p.kt)("span",{parentName:"span",className:"base"},(0,p.kt)("span",{parentName:"span",className:"strut",style:{height:"0.888em"}}),(0,p.kt)("span",{parentName:"span",className:"mord"},(0,p.kt)("span",{parentName:"span",className:"mord"},"2"),(0,p.kt)("span",{parentName:"span",className:"msupsub"},(0,p.kt)("span",{parentName:"span",className:"vlist-t"},(0,p.kt)("span",{parentName:"span",className:"vlist-r"},(0,p.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.888em"}},(0,p.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,p.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,p.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,p.kt)("span",{parentName:"span",className:"mord mtight"},(0,p.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"18"),(0,p.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,p.kt)("span",{parentName:"span",className:"mord mtight"},"16"),(0,p.kt)("span",{parentName:"span",className:"mclose mtight"},")"))))))))))))),' or 4 slots for each bucket. The utilisation of a batch is simply the highest number of filled slots out of all 65536 entries or "buckets". In this batch, none of the slots in any of the buckets have yet been filled with 4 chunks, so the batch is not yet fully utilised. The most filled slots out of all buckets is 2, so the stamp batch\'s utilisation is 2 out of 4. '),(0,p.kt)("p",null,(0,p.kt)("img",{src:e(85445).Z,width:"2703",height:"903"})),(0,p.kt)("p",null,"As more chunks get uploaded and stamped, the bucket slots will begin to fill. As soon as the slots for any SINGLE bucket get filled, the entire batch is considered 100% utilised and can no longer be used to upload additional chunks.  "),(0,p.kt)("p",null,(0,p.kt)("img",{src:e(67700).Z,width:"2703",height:"1023"})),(0,p.kt)("h3",{id:"mutable-batches"},"Mutable Batches"),(0,p.kt)("p",null,"Mutable batches use the same hash map structure as immutable batches, however its utilisation works very differently. In contrast with immutable batches, mutable batches are never considered fully utilised. Rather, at the point where an immutable batch would be considered fully utilised, a mutable batch can continue to stamp chunks. However, if any chunk's address lands in a bucket whose slots are already filled, that bucket's counter gets reset, and the new chunk will replace the oldest chunk in that bucket."),(0,p.kt)("p",null,(0,p.kt)("img",{src:e(85718).Z,width:"2703",height:"1113"})),(0,p.kt)("p",null,"Therefore rather than speaking of the number of slots as determining the utilisation of a batch as with immutable batches, we can think of the slots as defining a limit to the amount of data which can be uploaded before old data starts to get overwritten."))}g.isMDXComponent=!0},32544:function(a,t,e){t.Z=e.p+"assets/images/batches_01-e084efba3e803068f01309d12db9d7cb.png"},85445:function(a,t,e){t.Z=e.p+"assets/images/batches_02-b0d64e9f456ec3ced0720d7e923ab93e.png"},67700:function(a,t,e){t.Z=e.p+"assets/images/batches_03-d33365fe10a3274d74ddfdd0950bf610.png"},85718:function(a,t,e){t.Z=e.p+"assets/images/batches_04-82c8f844e94e1f8c2bdd58ec7c127780.png"}}]);